Refactor: Refactor the [method name] in [file name]

The Cyclomatic complexity of [method name] is [Cyclomatic complexity number]. 

Changes to make to [method name]:
- Reduce the Cyclomatic complexity
- Improve the structure to enhance code readability and maintainability.
